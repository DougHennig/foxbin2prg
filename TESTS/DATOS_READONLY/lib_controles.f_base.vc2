*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="lib_controles.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
DEFINE CLASS f_base AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Edit1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCapturar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: capturarpantallaabitmap
		*p: c_testname
	*</DefinedPropArrayMethod>

	*<PropValue>
		AlwaysOnTop = .T.
		BackColor = 192,192,192
		Caption = "OptionGroup_Test"
		c_testname = OptionGroup_Test
		DoCreate = .T.
		Height = 424
		Left = 0
		Name = "f_base"
		Top = 0
		Width = 819
	*</PropValue>

	ADD OBJECT 'cmdCapturar' AS commandbutton WITH ;
		Caption = "Capturar Pantalla", ;
		Height = 27, ;
		Left = 564, ;
		Name = "cmdCapturar", ;
		TabIndex = 1, ;
		Top = 392, ;
		Width = 248
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Edit1' AS editbox WITH ;
		Height = 356, ;
		Left = 564, ;
		Name = "Edit1", ;
		ReadOnly = .T., ;
		TabIndex = 2, ;
		Top = 32, ;
		Value = , ;
		Width = 249
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Label1' AS label WITH ;
		Alignment = 2, ;
		Caption = "OPTIONGROUP NORMAL", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 28, ;
		Name = "Label1", ;
		TabIndex = 4, ;
		Top = 8, ;
		Width = 244
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		Alignment = 2, ;
		Caption = "OPTIONGROUP SUBCLASADOS", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 296, ;
		Name = "Label2", ;
		TabIndex = 5, ;
		Top = 8, ;
		Width = 248
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		Alignment = 2, ;
		Caption = "OBSERVACIONES", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 564, ;
		Name = "Label3", ;
		TabIndex = 3, ;
		Top = 8, ;
		Width = 248
		*< END OBJECT: BaseClass="label" />
	
	PROCEDURE capturarpantallaabitmap
		LPARAMETERS tcFilename
		
		LOCAL retVal
		tcFilename	= EVL(tcFilename, 'optiongroup')
		
		IF NOT '\' $ tcFilename
			tcFilename	= SYS(5) + ADDBS(CURDIR()) + "TESTS\DATOS_TEST\" + tcFilename + '.bmp'
		ENDIF
		
		Declare Integer formtobmp IN "PCT_DLL.dll" integer hwnd,String bmpFileName
		retVal = formtobmp( THISFORM.HWnd, tcFilename )
		
		*Declare Integer formtobmpA  IN "TESTS\PCT_DLL.dll" string bmpfilename,integer nX,integer nY,integer nX2,integer nY2
		
		*retVal = formtobmpA( "c:\desa\foxbin2prg\screen0.bmp" ;
			, THIS.Left ;
			, this.Top ;
			, this.Left + this.Width ;
			, this.Top + this.Height )  && Save screen to file c:\screen.bmp
		CLEAR DLLS formtobmp
		
		RETURN retVal
		
	ENDPROC

	PROCEDURE Init
		SET PATH TO (FULLPATH("..\", THIS.ClassLibrary)) ADDITIVE
		THISFORM.cmdCapturar.SetFocus()
		
	ENDPROC

	PROCEDURE Refresh
		DODEFAULT()
		INKEY(0.01,"S")
		DOEVENTS FORCE
		this.capturarpantallaabitmap( THISFORM.c_testname )
		
	ENDPROC

	PROCEDURE cmdCapturar.Click
		THISFORM.capturarpantallaabitmap()
		
	ENDPROC

ENDDEFINE
